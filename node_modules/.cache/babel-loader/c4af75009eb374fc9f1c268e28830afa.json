{"ast":null,"code":"import _regeneratorRuntime from\"D:/Projects/Cdss apps/Final version/admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/Projects/Cdss apps/Final version/admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:/Projects/Cdss apps/Final version/admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import CircularProgress from'@mui/material/CircularProgress';import Card from'@mui/material/Card';import CardContent from'@mui/material/CardContent';import{Button,Typography}from'@mui/material';import{Modal as BootstrapModal}from'react-bootstrap';import Grid from'@mui/material/Grid';import Modal from'@mui/material/Modal';import Box from'@mui/material/Box';import{modalStyle}from'src/config';import Table from'@mui/material/Table';import TableBody from'@mui/material/TableBody';import TableCell from'@mui/material/TableCell';import TableContainer from'@mui/material/TableContainer';import TableHead from'@mui/material/TableHead';import CloseIcon from'@mui/icons-material/Close';import UserCoursesRow from'./UserCoursesRow';import{useSnackbar}from'notistack';import{cancelSubscription,getSubscriptionCourses}from'src/api/Subscription/Subscription';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function CancelSubscription(_ref){var modalVisible=_ref.modalVisible,setModalVisible=_ref.setModalVisible,sessionId=_ref.sessionId,userId=_ref.userId,updateStatusInParent=_ref.updateStatusInParent;var _useState=useState(),_useState2=_slicedToArray(_useState,2),message=_useState2[0],setMessage=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),cancelLoader=_useState4[0],setCancelLoader=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),courses=_useState6[0],setCourses=_useState6[1];var _useState7=useState(true),_useState8=_slicedToArray(_useState7,2),loader=_useState8[0],setLoader=_useState8[1];var _useSnackbar=useSnackbar(),enqueueSnackbar=_useSnackbar.enqueueSnackbar;useEffect(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setLoader(true);_context.next=3;return getSubscriptionCourses(userId,sessionId);case 3:response=_context.sent;if(response.status){setCourses(response.courses);}setLoader(false);case 6:case\"end\":return _context.stop();}}},_callee);})),[]);var cancelSubscriptionHandler=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!(message&&message!='')){_context2.next=10;break;}if(cancelLoader){_context2.next=8;break;}setCancelLoader(true);_context2.next=5;return cancelSubscription(userId,sessionId,message);case 5:response=_context2.sent;if(response.status){updateStatusInParent(\"canceled\");setModalVisible(false);enqueueSnackbar('Success',{variant:'success'});}setCancelLoader(false);case 8:_context2.next=11;break;case 10:enqueueSnackbar('Cancel reason is required',{variant:'error'});case 11:case\"end\":return _context2.stop();}}},_callee2);}));return function cancelSubscriptionHandler(){return _ref3.apply(this,arguments);};}();return/*#__PURE__*/_jsx(Modal,{open:modalVisible,size:\"lg\",\"aria-labelledby\":\"contained-modal-title-vcenter\",centered:true,onClose:function onClose(){return setModalVisible(false);},children:/*#__PURE__*/_jsxs(Box,{sx:modalStyle,children:[/*#__PURE__*/_jsx(BootstrapModal.Header,{className:\"clr-primary-400 py-2\",children:/*#__PURE__*/_jsxs(Grid,{container:true,children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:11,lg:11,md:11,sm:11,children:/*#__PURE__*/_jsx(Typography,{variant:\"h6\",children:\"Cancel Subscription\"})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:1,lg:1,md:1,children:/*#__PURE__*/_jsx(Button,{onClick:function onClick(){return setModalVisible(false);},children:/*#__PURE__*/_jsx(CloseIcon,{})})})]})}),/*#__PURE__*/_jsxs(BootstrapModal.Body,{children:[/*#__PURE__*/_jsx(Grid,{container:true,children:/*#__PURE__*/_jsxs(Grid,{item:true,md:10,xl:10,xs:10,children:[/*#__PURE__*/_jsx(\"label\",{children:\"Cancel Reason\"}),/*#__PURE__*/_jsx(\"textarea\",{className:\"form-control w-100\",onChange:function onChange(e){return setMessage(e.target.value);}})]})}),/*#__PURE__*/_jsx(Box,{sx:{mt:2},children:/*#__PURE__*/_jsx(TableContainer,{children:/*#__PURE__*/_jsxs(Table,{children:[/*#__PURE__*/_jsxs(TableHead,{children:[/*#__PURE__*/_jsx(TableCell,{children:\"S.No.\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Title\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Joined On\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Status\"})]}),/*#__PURE__*/_jsx(TableBody,{children:loader?/*#__PURE__*/_jsx(Box,{sx:{alignItems:'center',justifyContent:'center',display:'flex',width:\"100%\",height:\"100%\"},children:/*#__PURE__*/_jsx(CircularProgress,{size:20})}):courses.map(function(item,index){return/*#__PURE__*/_jsx(UserCoursesRow,{item:item,index:index});})})]})})}),/*#__PURE__*/_jsx(Typography,{sx:{mt:2,mb:2},children:\"Note: These Courses will be removed permanently from user account upon subcsription cancellation\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-center mt-4 pb-3\",children:/*#__PURE__*/_jsxs(Grid,{container:true,children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:5,lg:5,md:5,sm:5}),\"\\u2003\",/*#__PURE__*/_jsx(Grid,{item:true,xs:6,lg:6,md:6,sm:6,children:cancelLoader?/*#__PURE__*/_jsx(Button,{variant:\"outlined\",className:\" px-5\",children:/*#__PURE__*/_jsx(CircularProgress,{size:20})}):/*#__PURE__*/_jsx(Button,{variant:\"contained\",className:\" px-5\",onClick:function onClick(){cancelSubscriptionHandler();},children:\"Cancel Subscription\"})})]})})]})]})});}export default CancelSubscription;","map":{"version":3,"sources":["D:/Projects/Cdss apps/Final version/admin/src/pages/users/CancelSubscription.js"],"names":["React","useEffect","useState","CircularProgress","Card","CardContent","Button","Typography","Modal","BootstrapModal","Grid","Box","modalStyle","Table","TableBody","TableCell","TableContainer","TableHead","CloseIcon","UserCoursesRow","useSnackbar","cancelSubscription","getSubscriptionCourses","CancelSubscription","modalVisible","setModalVisible","sessionId","userId","updateStatusInParent","message","setMessage","cancelLoader","setCancelLoader","courses","setCourses","loader","setLoader","enqueueSnackbar","response","status","cancelSubscriptionHandler","variant","e","target","value","mt","alignItems","justifyContent","display","width","height","map","item","index","mb"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react'\nimport CircularProgress from '@mui/material/CircularProgress';\nimport Card from '@mui/material/Card';\nimport CardContent from '@mui/material/CardContent';\nimport { Button, Typography } from '@mui/material'\nimport { Modal as BootstrapModal } from 'react-bootstrap'\nimport Grid from '@mui/material/Grid';\nimport Modal from '@mui/material/Modal';\nimport Box from '@mui/material/Box';\nimport { modalStyle } from 'src/config'\nimport Table from '@mui/material/Table';\nimport TableBody from '@mui/material/TableBody';\nimport TableCell from '@mui/material/TableCell';\nimport TableContainer from '@mui/material/TableContainer';\nimport TableHead from '@mui/material/TableHead';  \nimport CloseIcon from '@mui/icons-material/Close';\nimport UserCoursesRow  from './UserCoursesRow'\nimport { useSnackbar } from 'notistack';\nimport { cancelSubscription, getSubscriptionCourses } from 'src/api/Subscription/Subscription';\nfunction CancelSubscription({modalVisible,setModalVisible,sessionId,userId,updateStatusInParent}) {\n    const [message,setMessage] = useState()\n    const [cancelLoader,setCancelLoader]  = useState(false)\n    const [courses,setCourses] = useState([])\n    const [loader,setLoader] = useState(true)\n    const { enqueueSnackbar } = useSnackbar();\n    useEffect(async()=>{\n\n        setLoader(true)\n        const response = await getSubscriptionCourses(userId,sessionId)\n        if(response.status)\n        {\n            setCourses(response.courses)\n        }\n        setLoader(false)\n    },[])\n\n    const cancelSubscriptionHandler=async ()=>\n    {\n            if(message&&message!='')\n            {\n                if(!cancelLoader)\n                {\n                    setCancelLoader(true)\n                    const response = await cancelSubscription(userId,sessionId,message)\n                    if(response.status)\n                    {\n                        updateStatusInParent(\"canceled\")\n                        setModalVisible(false)\n                        enqueueSnackbar('Success', { variant: 'success' });\n                    }\n                    setCancelLoader(false)\n                }\n                \n            }else\n            {\n                enqueueSnackbar('Cancel reason is required', { variant: 'error' });\n            }\n    }\n  return (\n    <Modal\n        open={modalVisible}\n        size=\"lg\"\n        aria-labelledby=\"contained-modal-title-vcenter\"\n        centered\n        onClose={() => setModalVisible(false)}\n    >\n        <Box sx={modalStyle}>\n            <BootstrapModal.Header className=\"clr-primary-400 py-2\">\n                    {/* <BootstrapModal.Title id=\"contained-modal-title-vcenter\" className=\"text-center\"> */}\n                        {/* <h4 className=\"text-center   mb-0\">\n                            Update Profile Image\n                        </h4> */}\n                         <Grid container>\n                              <Grid item xs={11} lg={11} md={11} sm={11}>\n                                  <Typography variant=\"h6\">\n                                      Cancel Subscription\n                                  </Typography>\n                              </Grid>\n                              <Grid item xs={1} lg={1} md={1}>\n                                  <Button  onClick={() => setModalVisible(false)}  >\n                                      <CloseIcon />\n                                  </Button>\n                              </Grid>\n                          </Grid>\n                         \n                    {/* </BootstrapModal.Title> */}\n                </BootstrapModal.Header>\n            <BootstrapModal.Body> \n                    <Grid container>\n                        <Grid item md={10} xl={10} xs={10}>\n                            <label>Cancel Reason</label>\n                            <textarea className=\"form-control w-100\" onChange={(e) =>setMessage(e.target.value)}></textarea>\n                        </Grid>\n                    </Grid>\n                    <Box sx={{mt:2}}>\n                        {/* <label style={{marginBottom:10}}> Courses was purchased in this transaction</label> */}\n                        <TableContainer>\n                                <Table>\n                                    <TableHead>\n                                        <TableCell>S.No.</TableCell> \n                                        <TableCell >Title</TableCell>\n                                        <TableCell >Joined On</TableCell>\n                                        <TableCell >Status</TableCell> \n                                    </TableHead>\n                                    <TableBody>\n\n                                        {loader?(\n\n                                                <Box sx={{alignItems: 'center',justifyContent: 'center',display: 'flex',width:\"100%\",height:\"100%\"}}>\n                                                    <CircularProgress size={20} />\n                                                </Box>\n\n                                        ):(\n\n                                        \n                                        \n                                        courses.map((item,index)=>(\n                                            <UserCoursesRow \n                                                item={item}\n                                                index={index}\n                                            />\n                                        ))\n                                        )}\n\n                                    </TableBody>\n                                </Table>\n                        </TableContainer>\n                    </Box>\n                   <Typography sx={{mt:2,mb:2}}>\n\n                       Note: These Courses will be removed permanently from user account upon subcsription cancellation\n                   </Typography>\n                    <div className=\"text-center mt-4 pb-3\">\n                            <Grid container>\n                                <Grid item xs={5} lg={5} md={5} sm={5}>\n                                    {/* <Button variant=\"outlined\" className=\" px-5\"\n                                        // onClick={()=>resetFilterData()}\n                                        onClick={() => {}}\n                                    >Go Back </Button> */}\n                                </Grid>\n                                &emsp;\n                                <Grid item xs={6} lg={6} md={6} sm={6}>\n                                    {cancelLoader ? (\n                                        <Button variant=\"outlined\" className=\" px-5\" >\n\n                                            <CircularProgress size={20} />\n                                        </Button>\n                                    ) : (\n                                        <Button variant=\"contained\" className=\" px-5\"\n                                            onClick={() => {cancelSubscriptionHandler()  }}\n                                        >Cancel Subscription</Button>\n                                     )}  \n                                </Grid>\n                            </Grid>\n                        </div>\n            </BootstrapModal.Body>\n        </Box>\n    </Modal>\n  )\n}\n\nexport default CancelSubscription"]},"metadata":{},"sourceType":"module"}