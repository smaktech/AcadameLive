{"ast":null,"code":"import _regeneratorRuntime from\"D:/Projects/Cdss apps/Final version/admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/Projects/Cdss apps/Final version/admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:/Projects/Cdss apps/Final version/admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import TableRow from'@mui/material/TableRow';import TableCell from'@mui/material/TableCell';import{Avatar,Button}from'@mui/material';import ToggleOnIcon from'@mui/icons-material/ToggleOn';import EditIcon from'@mui/icons-material/Edit';import ToggleOffIcon from'@mui/icons-material/ToggleOff';import DeleteIcon from'@mui/icons-material/Delete';import CircularProgress from'@mui/material/CircularProgress';import{Link,useNavigate,Redirect}from'react-router-dom';import{baseUrl}from'src/config';import CancelSubscription from'./CancelSubscription';import{refundSubscription}from'src/api/Subscription/Subscription';import{useSnackbar}from'notistack';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function UserPaymentRow(_ref){var item=_ref.item,index=_ref.index;var _useSnackbar=useSnackbar(),enqueueSnackbar=_useSnackbar.enqueueSnackbar;var navigate=useNavigate();//returns the created date of the record of the table\nfunction renderDate(date){var months=[\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\",\"September\",\"October\",\"November\",\"December\"];var newDate=new Date(date);var returnDate=months[newDate.getMonth()]+' '+newDate.getDate()+' '+newDate.getFullYear();return returnDate;}var _useState=useState(item.cancellationStatus),_useState2=_slicedToArray(_useState,2),cancellationStatus=_useState2[0],setCancellationStatus=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),modalVisible=_useState4[0],setModalVisible=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),refundLoader=_useState6[0],setRefundLoader=_useState6[1];var refundSubscriptionHandler=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(refundLoader){_context.next=7;break;}setRefundLoader(true);_context.next=4;return refundSubscription(item.userID._id,item.transactionID);case 4:response=_context.sent;if(response.status){setCancellationStatus(\"refunded\");setModalVisible(false);enqueueSnackbar('Success',{variant:'success'});}setRefundLoader(false);case 7:case\"end\":return _context.stop();}}},_callee);}));return function refundSubscriptionHandler(){return _ref2.apply(this,arguments);};}();useEffect(function(){setCancellationStatus(item.cancellationStatus);},[item]);console.log(item.cancellationMessage,\" item\");return/*#__PURE__*/_jsxs(TableRow,{sx:{'&:last-child td, &:last-child th':{border:0}},children:[/*#__PURE__*/_jsx(TableCell,{children:index+1}),/*#__PURE__*/_jsx(TableCell,{children:item.transactionID}),/*#__PURE__*/_jsx(TableCell,{children:renderDate(item.transactionDate)}),/*#__PURE__*/_jsx(TableCell,{children:item.status?'Completed':'Cancelled'}),/*#__PURE__*/_jsx(TableCell,{children:item.amount}),/*#__PURE__*/_jsx(TableCell,{children:cancellationStatus==\"canceled\"?\"Cancelled\":cancellationStatus==\"refunded\"?\"Refunded\":\"N.A.\"}),/*#__PURE__*/_jsx(TableCell,{children:item.cancellationDate?renderDate(item.cancellationDate):\"N.A.\"}),/*#__PURE__*/_jsx(TableCell,{children:item.cancellationMessage}),/*#__PURE__*/_jsx(TableCell,{children:cancellationStatus==\"canceled\"?refundLoader?/*#__PURE__*/_jsx(Button,{variant:\"outlined\",className:\" px-5\",children:/*#__PURE__*/_jsx(CircularProgress,{size:20})}):/*#__PURE__*/_jsx(Button,{variant:\"contained\",onClick:function onClick(){return refundSubscriptionHandler();},children:\" Mark Refunded \"}):cancellationStatus!=\"refunded\"?/*#__PURE__*/_jsx(Button,{variant:\"contained\",onClick:function onClick(){return setModalVisible(true);},children:\" Cancel \"}):null}),modalVisible&&/*#__PURE__*/_jsx(CancelSubscription,{modalVisible:modalVisible,setModalVisible:setModalVisible,userId:item.userID._id,sessionId:item.transactionID,updateStatusInParent:setCancellationStatus})]},index);}export default UserPaymentRow;","map":{"version":3,"sources":["D:/Projects/Cdss apps/Final version/admin/src/pages/users/UserPaymentRow.js"],"names":["React","useState","useEffect","TableRow","TableCell","Avatar","Button","ToggleOnIcon","EditIcon","ToggleOffIcon","DeleteIcon","CircularProgress","Link","useNavigate","Redirect","baseUrl","CancelSubscription","refundSubscription","useSnackbar","UserPaymentRow","item","index","enqueueSnackbar","navigate","renderDate","date","months","newDate","Date","returnDate","getMonth","getDate","getFullYear","cancellationStatus","setCancellationStatus","modalVisible","setModalVisible","refundLoader","setRefundLoader","refundSubscriptionHandler","userID","_id","transactionID","response","status","variant","console","log","cancellationMessage","border","transactionDate","amount","cancellationDate"],"mappings":"6dAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAAyBC,SAAzB,KAA0C,OAA1C,CAEA,MAAOC,CAAAA,QAAP,KAAqB,wBAArB,CAEA,MAAOC,CAAAA,SAAP,KAAsB,yBAAtB,CACA,OAASC,MAAT,CAAiBC,MAAjB,KAA+B,eAA/B,CACA,MAAOC,CAAAA,YAAP,KAAyB,8BAAzB,CACA,MAAOC,CAAAA,QAAP,KAAqB,0BAArB,CACA,MAAOC,CAAAA,aAAP,KAA0B,+BAA1B,CACA,MAAOC,CAAAA,UAAP,KAAuB,4BAAvB,CAEA,MAAOC,CAAAA,gBAAP,KAA6B,gCAA7B,CAEA,OAASC,IAAT,CAAeC,WAAf,CAA4BC,QAA5B,KAA4C,kBAA5C,CACA,OAASC,OAAT,KAAwB,YAAxB,CACA,MAAOC,CAAAA,kBAAP,KAA+B,sBAA/B,CACA,OAASC,kBAAT,KAAmC,mCAAnC,CACA,OAASC,WAAT,KAA4B,WAA5B,C,wFACA,QAASC,CAAAA,cAAT,MAAyC,IAAfC,CAAAA,IAAe,MAAfA,IAAe,CAATC,KAAS,MAATA,KAAS,CAErC,iBAA4BH,WAAW,EAAvC,CAAQI,eAAR,cAAQA,eAAR,CACA,GAAMC,CAAAA,QAAQ,CAAGV,WAAW,EAA5B,CACA;AACA,QAASW,CAAAA,UAAT,CAAoBC,IAApB,CAA0B,CACtB,GAAMC,CAAAA,MAAM,CAAG,CAAC,SAAD,CAAY,UAAZ,CAAwB,OAAxB,CAAiC,OAAjC,CAA0C,KAA1C,CAAiD,MAAjD,CAAyD,MAAzD,CAAiE,QAAjE,CAA2E,WAA3E,CAAwF,SAAxF,CAAmG,UAAnG,CAA+G,UAA/G,CAAf,CACA,GAAMC,CAAAA,OAAO,CAAG,GAAIC,CAAAA,IAAJ,CAASH,IAAT,CAAhB,CACA,GAAMI,CAAAA,UAAU,CAAGH,MAAM,CAACC,OAAO,CAACG,QAAR,EAAD,CAAN,CAA6B,GAA7B,CAAmCH,OAAO,CAACI,OAAR,EAAnC,CAAuD,GAAvD,CAA6DJ,OAAO,CAACK,WAAR,EAAhF,CACA,MAAOH,CAAAA,UAAP,CACH,CAED,cAAmD5B,QAAQ,CAACmB,IAAI,CAACa,kBAAN,CAA3D,wCAAOA,kBAAP,eAA0BC,qBAA1B,eACA,eAAwCjC,QAAQ,CAAC,KAAD,CAAhD,yCAAOkC,YAAP,eAAqBC,eAArB,eACA,eAAuCnC,QAAQ,CAAC,KAAD,CAA/C,yCAAOoC,YAAP,eAAoBC,eAApB,eAIA,GAAMC,CAAAA,yBAAyB,2FAAC,mJAGhBF,YAHgB,yBAKhBC,eAAe,CAAC,IAAD,CAAf,CALgB,sBAMOrB,CAAAA,kBAAkB,CAACG,IAAI,CAACoB,MAAL,CAAYC,GAAb,CAAiBrB,IAAI,CAACsB,aAAtB,CANzB,QAMVC,QANU,eAOhB,GAAGA,QAAQ,CAACC,MAAZ,CACA,CACIV,qBAAqB,CAAC,UAAD,CAArB,CACAE,eAAe,CAAC,KAAD,CAAf,CACAd,eAAe,CAAC,SAAD,CAAY,CAAEuB,OAAO,CAAE,SAAX,CAAZ,CAAf,CACH,CACDP,eAAe,CAAC,KAAD,CAAf,CAbgB,sDAAD,kBAAzBC,CAAAA,yBAAyB,2CAA/B,CAkBArC,SAAS,CAAC,UAAM,CACZgC,qBAAqB,CAACd,IAAI,CAACa,kBAAN,CAArB,CACH,CAFQ,CAEP,CAACb,IAAD,CAFO,CAAT,CAGA0B,OAAO,CAACC,GAAR,CAAY3B,IAAI,CAAC4B,mBAAjB,CAAqC,OAArC,EACA,mBACI,MAAC,QAAD,EAEI,EAAE,CAAE,CAAE,mCAAoC,CAAEC,MAAM,CAAE,CAAV,CAAtC,CAFR,wBAII,KAAC,SAAD,WACK5B,KAAK,CAAG,CADb,EAJJ,cAOI,KAAC,SAAD,WACMD,IAAI,CAACsB,aADX,EAPJ,cAUI,KAAC,SAAD,WACSlB,UAAU,CAACJ,IAAI,CAAC8B,eAAN,CADnB,EAVJ,cAaI,KAAC,SAAD,WAAY9B,IAAI,CAACwB,MAAL,CAAa,WAAb,CAA6B,WAAzC,EAbJ,cAcI,KAAC,SAAD,WAAYxB,IAAI,CAAC+B,MAAjB,EAdJ,cAeI,KAAC,SAAD,WACMlB,kBAAkB,EAAE,UAApB,CAAgC,WAAhC,CAA6CA,kBAAkB,EAAE,UAApB,CAAgC,UAAhC,CAA6C,MADhG,EAfJ,cAkBI,KAAC,SAAD,WACKb,IAAI,CAACgC,gBAAL,CAAsB5B,UAAU,CAACJ,IAAI,CAACgC,gBAAN,CAAhC,CAAyD,MAD9D,EAlBJ,cAqBI,KAAC,SAAD,WACKhC,IAAI,CAAC4B,mBADV,EArBJ,cAwBI,KAAC,SAAD,WACKf,kBAAkB,EAAE,UAApB,CACII,YAAY,cACT,KAAC,MAAD,EAAQ,OAAO,CAAC,UAAhB,CAA2B,SAAS,CAAC,OAArC,uBAEI,KAAC,gBAAD,EAAkB,IAAI,CAAE,EAAxB,EAFJ,EADS,cAMT,KAAC,MAAD,EAAS,OAAO,CAAC,WAAjB,CAA6B,OAAO,CAAE,yBAAIE,CAAAA,yBAAyB,EAA7B,EAAtC,6BAPP,CAUGN,kBAAkB,EAAE,UAApB,cACI,KAAC,MAAD,EAAS,OAAO,CAAC,WAAjB,CAA6B,OAAO,CAAE,yBAAIG,CAAAA,eAAe,CAAC,IAAD,CAAnB,EAAtC,sBADJ,CAEG,IAbX,EAxBJ,CA4CID,YAAY,eAAE,KAAC,kBAAD,EACV,YAAY,CAAEA,YADJ,CAEV,eAAe,CAAEC,eAFP,CAGV,MAAM,CAAEhB,IAAI,CAACoB,MAAL,CAAYC,GAHV,CAIV,SAAS,CAAErB,IAAI,CAACsB,aAJN,CAKV,oBAAoB,CAAGR,qBALb,EA5ClB,GACSb,KADT,CADJ,CAsDH,CAED,cAAeF,CAAAA,cAAf","sourcesContent":["import React, { useState,useEffect } from 'react'\n\nimport TableRow from '@mui/material/TableRow';\n\nimport TableCell from '@mui/material/TableCell';\nimport { Avatar, Button } from '@mui/material';\nimport ToggleOnIcon from '@mui/icons-material/ToggleOn';\nimport EditIcon from '@mui/icons-material/Edit';\nimport ToggleOffIcon from '@mui/icons-material/ToggleOff';\nimport DeleteIcon from '@mui/icons-material/Delete';\n\nimport CircularProgress from '@mui/material/CircularProgress';\n\nimport { Link, useNavigate, Redirect } from 'react-router-dom'\nimport { baseUrl } from 'src/config';\nimport CancelSubscription from './CancelSubscription';\nimport { refundSubscription } from 'src/api/Subscription/Subscription';\nimport { useSnackbar } from 'notistack';\nfunction UserPaymentRow({ item, index }) {\n     \n    const { enqueueSnackbar } = useSnackbar();\n    const navigate = useNavigate()\n    //returns the created date of the record of the table\n    function renderDate(date) {\n        const months = [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"];\n        const newDate = new Date(date);\n        const returnDate = months[newDate.getMonth()] + ' ' + newDate.getDate() + ' ' + newDate.getFullYear();\n        return returnDate;\n    }\n\n    const [cancellationStatus,setCancellationStatus] = useState(item.cancellationStatus)\n    const [modalVisible, setModalVisible] = useState(false)\n    const [refundLoader,setRefundLoader] = useState(false)\n\n\n\n    const refundSubscriptionHandler=async ()=>\n    {\n            \n                if(!refundLoader)\n                {\n                    setRefundLoader(true)\n                    const response = await refundSubscription(item.userID._id,item.transactionID)\n                    if(response.status)\n                    {\n                        setCancellationStatus(\"refunded\")\n                        setModalVisible(false)\n                        enqueueSnackbar('Success', { variant: 'success' });\n                    }\n                    setRefundLoader(false)\n                }\n                \n            \n    }\n    useEffect(() => {\n        setCancellationStatus(item.cancellationStatus)\n    },[item])\n    console.log(item.cancellationMessage,\" item\")\n    return (\n        <TableRow\n            key={index}\n            sx={{ '&:last-child td, &:last-child th': { border: 0 } }}\n        >\n            <TableCell>\n                {index + 1}\n            </TableCell>\n            <TableCell>\n                 {item.transactionID}\n            </TableCell>\n            <TableCell>\n                    {renderDate(item.transactionDate)}\n            </TableCell>\n            <TableCell>{item.status?('Completed') : ('Cancelled')}</TableCell>\n            <TableCell>{item.amount}</TableCell> \n            <TableCell>\n                 {cancellationStatus==\"canceled\"?(\"Cancelled\"):cancellationStatus==\"refunded\"?(\"Refunded\"):(\"N.A.\")}\n            </TableCell>\n            <TableCell>\n                {item.cancellationDate?renderDate(item.cancellationDate):(\"N.A.\")}\n            </TableCell> \n            <TableCell>\n                {item.cancellationMessage}\n            </TableCell> \n            <TableCell>\n                {cancellationStatus==\"canceled\"?(\n                     refundLoader ? (\n                        <Button variant=\"outlined\" className=\" px-5\" >\n\n                            <CircularProgress size={20} />\n                        </Button>\n                    ) :(\n                        <Button  variant=\"contained\" onClick={()=>refundSubscriptionHandler()}> Mark Refunded </Button>\n                    )\n                ):(\n                    cancellationStatus!=\"refunded\"?(\n                        <Button  variant=\"contained\" onClick={()=>setModalVisible(true)}> Cancel </Button>  \n                    ):(null)\n                    \n                )}\n                \n            </TableCell> \n             \n                                \n           {modalVisible&&<CancelSubscription\n                modalVisible={modalVisible}\n                setModalVisible={setModalVisible}\n                userId={item.userID._id}\n                sessionId={item.transactionID}\n                updateStatusInParent ={setCancellationStatus}\n            />}\n        </TableRow>\n    )\n}\n\nexport default UserPaymentRow\n"]},"metadata":{},"sourceType":"module"}