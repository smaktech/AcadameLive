{"ast":null,"code":"var _jsxFileName = \"D:\\\\Projects\\\\Cdss apps\\\\Final version\\\\admin\\\\src\\\\pages\\\\dashboard\\\\EcommerceShop.js\",\n    _s = $RefreshSig$();\n\nimport { useFormik } from 'formik';\nimport { useEffect, useState } from 'react';\nimport { filter, includes, orderBy } from 'lodash'; // @mui\n\nimport { Backdrop, Container, Typography, CircularProgress, Stack } from '@mui/material'; // redux\n\nimport { useDispatch, useSelector } from '../../redux/store';\nimport { getProducts, filterProducts } from '../../redux/slices/product'; // routes\n\nimport { PATH_DASHBOARD } from '../../routes/paths'; // hooks\n\nimport useSettings from '../../hooks/useSettings'; // components\n\nimport Page from '../../components/Page';\nimport HeaderBreadcrumbs from '../../components/HeaderBreadcrumbs'; // sections\n\nimport { ShopTagFiltered, ShopProductSort, ShopProductList, ShopFilterSidebar, ShopProductSearch } from '../../sections/@dashboard/e-commerce/shop';\nimport CartWidget from '../../sections/@dashboard/e-commerce/CartWidget'; // ----------------------------------------------------------------------\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function EcommerceShop() {\n  _s();\n\n  const {\n    themeStretch\n  } = useSettings();\n  const dispatch = useDispatch();\n  const [openFilter, setOpenFilter] = useState(false);\n  const {\n    products,\n    sortBy,\n    filters\n  } = useSelector(state => state.product);\n  const filteredProducts = applyFilter(products, sortBy, filters);\n  const formik = useFormik({\n    initialValues: {\n      gender: filters.gender,\n      category: filters.category,\n      colors: filters.colors,\n      priceRange: filters.priceRange,\n      rating: filters.rating\n    },\n    onSubmit: async (values, _ref) => {\n      let {\n        setSubmitting\n      } = _ref;\n\n      try {\n        await new Promise(resolve => setTimeout(resolve, 500));\n        setSubmitting(false);\n      } catch (error) {\n        console.error(error);\n        setSubmitting(false);\n      }\n    }\n  });\n  const {\n    values,\n    resetForm,\n    handleSubmit,\n    isSubmitting\n  } = formik;\n  const isDefault = !values.priceRange && !values.rating && values.gender.length === 0 && values.colors.length === 0 && values.category === 'All';\n  useEffect(() => {\n    dispatch(getProducts());\n  }, [dispatch]);\n  useEffect(() => {\n    dispatch(filterProducts(values));\n  }, [dispatch, values]);\n\n  const handleOpenFilter = () => {\n    setOpenFilter(true);\n  };\n\n  const handleCloseFilter = () => {\n    setOpenFilter(false);\n  };\n\n  const handleResetFilter = () => {\n    handleSubmit();\n    resetForm();\n  };\n\n  return /*#__PURE__*/_jsxDEV(Page, {\n    title: \"Ecommerce: Shop\",\n    children: [values && /*#__PURE__*/_jsxDEV(Backdrop, {\n      open: isSubmitting,\n      sx: {\n        zIndex: 9999\n      },\n      children: /*#__PURE__*/_jsxDEV(CircularProgress, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(Container, {\n      maxWidth: themeStretch ? false : 'lg',\n      children: [/*#__PURE__*/_jsxDEV(HeaderBreadcrumbs, {\n        heading: \"Shop\",\n        links: [{\n          name: 'Dashboard',\n          href: PATH_DASHBOARD.root\n        }, {\n          name: 'E-Commerce',\n          href: PATH_DASHBOARD.classes.root\n        }, {\n          name: 'Shop'\n        }]\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Stack, {\n        spacing: 2,\n        direction: {\n          xs: 'column',\n          sm: 'row'\n        },\n        alignItems: {\n          sm: 'center'\n        },\n        justifyContent: \"space-between\",\n        sx: {\n          mb: 2\n        },\n        children: [/*#__PURE__*/_jsxDEV(ShopProductSearch, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Stack, {\n          direction: \"row\",\n          spacing: 1,\n          flexShrink: 0,\n          sx: {\n            my: 1\n          },\n          children: [/*#__PURE__*/_jsxDEV(ShopFilterSidebar, {\n            formik: formik,\n            isOpenFilter: openFilter,\n            onResetFilter: handleResetFilter,\n            onOpenFilter: handleOpenFilter,\n            onCloseFilter: handleCloseFilter\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 116,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(ShopProductSort, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 123,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 115,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Stack, {\n        sx: {\n          mb: 3\n        },\n        children: !isDefault && /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(Typography, {\n            variant: \"body2\",\n            gutterBottom: true,\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: filteredProducts.length\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 131,\n              columnNumber: 17\n            }, this), \"\\xA0Products found\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 130,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(ShopTagFiltered, {\n            filters: filters,\n            formik: formik,\n            isShowReset: openFilter,\n            onResetFilter: handleResetFilter,\n            isDefault: isDefault\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 135,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(ShopProductList, {\n        products: filteredProducts,\n        isDefault: isDefault\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 146,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(CartWidget, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 86,\n    columnNumber: 5\n  }, this);\n} // ----------------------------------------------------------------------\n\n_s(EcommerceShop, \"yUyruTFfJoUUXkGpy+QJCeOQRpw=\", false, function () {\n  return [useSettings, useDispatch, useSelector, useFormik];\n});\n\n_c = EcommerceShop;\n\nfunction applyFilter(products, sortBy, filters) {\n  // SORT BY\n  if (sortBy === 'featured') {\n    products = orderBy(products, ['sold'], ['desc']);\n  }\n\n  if (sortBy === 'newest') {\n    products = orderBy(products, ['createdAt'], ['desc']);\n  }\n\n  if (sortBy === 'priceDesc') {\n    products = orderBy(products, ['price'], ['desc']);\n  }\n\n  if (sortBy === 'priceAsc') {\n    products = orderBy(products, ['price'], ['asc']);\n  } // FILTER PRODUCTS\n\n\n  if (filters.gender.length > 0) {\n    products = filter(products, _product => includes(filters.gender, _product.gender));\n  }\n\n  if (filters.category !== 'All') {\n    products = filter(products, _product => _product.category === filters.category);\n  }\n\n  if (filters.colors.length > 0) {\n    products = filter(products, _product => _product.colors.some(color => filters.colors.includes(color)));\n  }\n\n  if (filters.priceRange) {\n    products = filter(products, _product => {\n      if (filters.priceRange === 'below') {\n        return _product.price < 25;\n      }\n\n      if (filters.priceRange === 'between') {\n        return _product.price >= 25 && _product.price <= 75;\n      }\n\n      return _product.price > 75;\n    });\n  }\n\n  if (filters.rating) {\n    products = filter(products, _product => {\n      const convertRating = value => {\n        if (value === 'up4Star') return 4;\n        if (value === 'up3Star') return 3;\n        if (value === 'up2Star') return 2;\n        return 1;\n      };\n\n      return _product.totalRating > convertRating(filters.rating);\n    });\n  }\n\n  return products;\n}\n\nvar _c;\n\n$RefreshReg$(_c, \"EcommerceShop\");","map":{"version":3,"sources":["D:/Projects/Cdss apps/Final version/admin/src/pages/dashboard/EcommerceShop.js"],"names":["useFormik","useEffect","useState","filter","includes","orderBy","Backdrop","Container","Typography","CircularProgress","Stack","useDispatch","useSelector","getProducts","filterProducts","PATH_DASHBOARD","useSettings","Page","HeaderBreadcrumbs","ShopTagFiltered","ShopProductSort","ShopProductList","ShopFilterSidebar","ShopProductSearch","CartWidget","EcommerceShop","themeStretch","dispatch","openFilter","setOpenFilter","products","sortBy","filters","state","product","filteredProducts","applyFilter","formik","initialValues","gender","category","colors","priceRange","rating","onSubmit","values","setSubmitting","Promise","resolve","setTimeout","error","console","resetForm","handleSubmit","isSubmitting","isDefault","length","handleOpenFilter","handleCloseFilter","handleResetFilter","zIndex","name","href","root","classes","xs","sm","mb","my","_product","some","color","price","convertRating","value","totalRating"],"mappings":"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","sourcesContent":["import { useFormik } from 'formik';\nimport { useEffect, useState } from 'react';\nimport { filter, includes, orderBy } from 'lodash';\n// @mui\nimport { Backdrop, Container, Typography, CircularProgress, Stack } from '@mui/material';\n// redux\nimport { useDispatch, useSelector } from '../../redux/store';\nimport { getProducts, filterProducts } from '../../redux/slices/product';\n// routes\nimport { PATH_DASHBOARD } from '../../routes/paths';\n// hooks\nimport useSettings from '../../hooks/useSettings';\n// components\nimport Page from '../../components/Page';\nimport HeaderBreadcrumbs from '../../components/HeaderBreadcrumbs';\n// sections\nimport {\n  ShopTagFiltered,\n  ShopProductSort,\n  ShopProductList,\n  ShopFilterSidebar,\n  ShopProductSearch,\n} from '../../sections/@dashboard/e-commerce/shop';\nimport CartWidget from '../../sections/@dashboard/e-commerce/CartWidget';\n\n// ----------------------------------------------------------------------\n\nexport default function EcommerceShop() {\n  const { themeStretch } = useSettings();\n  const dispatch = useDispatch();\n  const [openFilter, setOpenFilter] = useState(false);\n  const { products, sortBy, filters } = useSelector((state) => state.product);\n\n  const filteredProducts = applyFilter(products, sortBy, filters);\n\n  const formik = useFormik({\n    initialValues: {\n      gender: filters.gender,\n      category: filters.category,\n      colors: filters.colors,\n      priceRange: filters.priceRange,\n      rating: filters.rating,\n    },\n    onSubmit: async (values, { setSubmitting }) => {\n      try {\n        await new Promise((resolve) => setTimeout(resolve, 500));\n        setSubmitting(false);\n      } catch (error) {\n        console.error(error);\n        setSubmitting(false);\n      }\n    },\n  });\n\n  const { values, resetForm, handleSubmit, isSubmitting } = formik;\n\n  const isDefault =\n    !values.priceRange &&\n    !values.rating &&\n    values.gender.length === 0 &&\n    values.colors.length === 0 &&\n    values.category === 'All';\n\n  useEffect(() => {\n    dispatch(getProducts());\n  }, [dispatch]);\n\n  useEffect(() => {\n    dispatch(filterProducts(values));\n  }, [dispatch, values]);\n\n  const handleOpenFilter = () => {\n    setOpenFilter(true);\n  };\n\n  const handleCloseFilter = () => {\n    setOpenFilter(false);\n  };\n\n  const handleResetFilter = () => {\n    handleSubmit();\n    resetForm();\n  };\n\n  return (\n    <Page title=\"Ecommerce: Shop\">\n      {values && (\n        <Backdrop open={isSubmitting} sx={{ zIndex: 9999 }}>\n          <CircularProgress />\n        </Backdrop>\n      )}\n\n      <Container maxWidth={themeStretch ? false : 'lg'}>\n        <HeaderBreadcrumbs\n          heading=\"Shop\"\n          links={[\n            { name: 'Dashboard', href: PATH_DASHBOARD.root },\n            {\n              name: 'E-Commerce',\n              href: PATH_DASHBOARD.classes.root,\n            },\n            { name: 'Shop' },\n          ]}\n        />\n\n        <Stack\n          spacing={2}\n          direction={{ xs: 'column', sm: 'row' }}\n          alignItems={{ sm: 'center' }}\n          justifyContent=\"space-between\"\n          sx={{ mb: 2 }}\n        >\n          <ShopProductSearch />\n\n          <Stack direction=\"row\" spacing={1} flexShrink={0} sx={{ my: 1 }}>\n            <ShopFilterSidebar\n              formik={formik}\n              isOpenFilter={openFilter}\n              onResetFilter={handleResetFilter}\n              onOpenFilter={handleOpenFilter}\n              onCloseFilter={handleCloseFilter}\n            />\n            <ShopProductSort />\n          </Stack>\n        </Stack>\n\n        <Stack sx={{ mb: 3 }}>\n          {!isDefault && (\n            <>\n              <Typography variant=\"body2\" gutterBottom>\n                <strong>{filteredProducts.length}</strong>\n                &nbsp;Products found\n              </Typography>\n\n              <ShopTagFiltered\n                filters={filters}\n                formik={formik}\n                isShowReset={openFilter}\n                onResetFilter={handleResetFilter}\n                isDefault={isDefault}\n              />\n            </>\n          )}\n        </Stack>\n\n        <ShopProductList products={filteredProducts} isDefault={isDefault} />\n        <CartWidget />\n      </Container>\n    </Page>\n  );\n}\n\n// ----------------------------------------------------------------------\n\nfunction applyFilter(products, sortBy, filters) {\n  // SORT BY\n  if (sortBy === 'featured') {\n    products = orderBy(products, ['sold'], ['desc']);\n  }\n  if (sortBy === 'newest') {\n    products = orderBy(products, ['createdAt'], ['desc']);\n  }\n  if (sortBy === 'priceDesc') {\n    products = orderBy(products, ['price'], ['desc']);\n  }\n  if (sortBy === 'priceAsc') {\n    products = orderBy(products, ['price'], ['asc']);\n  }\n  // FILTER PRODUCTS\n  if (filters.gender.length > 0) {\n    products = filter(products, (_product) => includes(filters.gender, _product.gender));\n  }\n  if (filters.category !== 'All') {\n    products = filter(products, (_product) => _product.category === filters.category);\n  }\n  if (filters.colors.length > 0) {\n    products = filter(products, (_product) => _product.colors.some((color) => filters.colors.includes(color)));\n  }\n  if (filters.priceRange) {\n    products = filter(products, (_product) => {\n      if (filters.priceRange === 'below') {\n        return _product.price < 25;\n      }\n      if (filters.priceRange === 'between') {\n        return _product.price >= 25 && _product.price <= 75;\n      }\n      return _product.price > 75;\n    });\n  }\n  if (filters.rating) {\n    products = filter(products, (_product) => {\n      const convertRating = (value) => {\n        if (value === 'up4Star') return 4;\n        if (value === 'up3Star') return 3;\n        if (value === 'up2Star') return 2;\n        return 1;\n      };\n      return _product.totalRating > convertRating(filters.rating);\n    });\n  }\n  return products;\n}\n"]},"metadata":{},"sourceType":"module"}