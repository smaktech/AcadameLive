{"ast":null,"code":"import _regeneratorRuntime from\"D:/Projects/Cdss apps/Final version/admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/Projects/Cdss apps/Final version/admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _objectSpread from\"D:/Projects/Cdss apps/Final version/admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _toConsumableArray from\"D:/Projects/Cdss apps/Final version/admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import{createSlice}from'@reduxjs/toolkit';import{sum,map,filter,uniqBy}from'lodash';// utils\nimport axios from'../../utils/axios';//\nimport{dispatch}from'../store';// ----------------------------------------------------------------------\nvar initialState={isLoading:false,error:null,products:[],product:null,sortBy:null,filters:{gender:[],category:'All',colors:[],priceRange:'',rating:''},checkout:{activeStep:0,cart:[],subtotal:0,total:0,discount:0,shipping:0,billing:null}};var slice=createSlice({name:'product',initialState:initialState,reducers:{// START LOADING\nstartLoading:function startLoading(state){state.isLoading=true;},// HAS ERROR\nhasError:function hasError(state,action){state.isLoading=false;state.error=action.payload;},// GET PRODUCTS\ngetProductsSuccess:function getProductsSuccess(state,action){state.isLoading=false;state.products=action.payload;},// GET PRODUCT\ngetProductSuccess:function getProductSuccess(state,action){state.isLoading=false;state.product=action.payload;},//  SORT & FILTER PRODUCTS\nsortByProducts:function sortByProducts(state,action){state.sortBy=action.payload;},filterProducts:function filterProducts(state,action){state.filters.gender=action.payload.gender;state.filters.category=action.payload.category;state.filters.colors=action.payload.colors;state.filters.priceRange=action.payload.priceRange;state.filters.rating=action.payload.rating;},// CHECKOUT\ngetCart:function getCart(state,action){var cart=action.payload;var subtotal=sum(cart.map(function(cartItem){return cartItem.price*cartItem.quantity;}));var discount=cart.length===0?0:state.checkout.discount;var shipping=cart.length===0?0:state.checkout.shipping;var billing=cart.length===0?null:state.checkout.billing;state.checkout.cart=cart;state.checkout.discount=discount;state.checkout.shipping=shipping;state.checkout.billing=billing;state.checkout.subtotal=subtotal;state.checkout.total=subtotal-discount;},addCart:function addCart(state,action){var product=action.payload;var isEmptyCart=state.checkout.cart.length===0;if(isEmptyCart){state.checkout.cart=[].concat(_toConsumableArray(state.checkout.cart),[product]);}else{state.checkout.cart=map(state.checkout.cart,function(_product){var isExisted=_product.id===product.id;if(isExisted){return _objectSpread(_objectSpread({},_product),{},{quantity:_product.quantity+1});}return _product;});}state.checkout.cart=uniqBy([].concat(_toConsumableArray(state.checkout.cart),[product]),'id');},deleteCart:function deleteCart(state,action){var updateCart=filter(state.checkout.cart,function(item){return item.id!==action.payload;});state.checkout.cart=updateCart;},resetCart:function resetCart(state){state.checkout.activeStep=0;state.checkout.cart=[];state.checkout.total=0;state.checkout.subtotal=0;state.checkout.discount=0;state.checkout.shipping=0;state.checkout.billing=null;},onBackStep:function onBackStep(state){state.checkout.activeStep-=1;},onNextStep:function onNextStep(state){state.checkout.activeStep+=1;},onGotoStep:function onGotoStep(state,action){var goToStep=action.payload;state.checkout.activeStep=goToStep;},increaseQuantity:function increaseQuantity(state,action){var productId=action.payload;var updateCart=map(state.checkout.cart,function(product){if(product.id===productId){return _objectSpread(_objectSpread({},product),{},{quantity:product.quantity+1});}return product;});state.checkout.cart=updateCart;},decreaseQuantity:function decreaseQuantity(state,action){var productId=action.payload;var updateCart=map(state.checkout.cart,function(product){if(product.id===productId){return _objectSpread(_objectSpread({},product),{},{quantity:product.quantity-1});}return product;});state.checkout.cart=updateCart;},createBilling:function createBilling(state,action){state.checkout.billing=action.payload;},applyDiscount:function applyDiscount(state,action){var discount=action.payload;state.checkout.discount=discount;state.checkout.total=state.checkout.subtotal-discount;},applyShipping:function applyShipping(state,action){var shipping=action.payload;state.checkout.shipping=shipping;state.checkout.total=state.checkout.subtotal-state.checkout.discount+shipping;}}});// Reducer\nexport default slice.reducer;// Actions\nvar _slice$actions=slice.actions,getCart=_slice$actions.getCart,addCart=_slice$actions.addCart,resetCart=_slice$actions.resetCart,onGotoStep=_slice$actions.onGotoStep,onBackStep=_slice$actions.onBackStep,onNextStep=_slice$actions.onNextStep,deleteCart=_slice$actions.deleteCart,createBilling=_slice$actions.createBilling,applyShipping=_slice$actions.applyShipping,applyDiscount=_slice$actions.applyDiscount,increaseQuantity=_slice$actions.increaseQuantity,decreaseQuantity=_slice$actions.decreaseQuantity,sortByProducts=_slice$actions.sortByProducts,filterProducts=_slice$actions.filterProducts;// ----------------------------------------------------------------------\nexport{getCart,addCart,resetCart,onGotoStep,onBackStep,onNextStep,deleteCart,createBilling,applyShipping,applyDiscount,increaseQuantity,decreaseQuantity,sortByProducts,filterProducts};export function getProducts(){return/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dispatch(slice.actions.startLoading());_context.prev=1;_context.next=4;return axios.get('/api/products');case 4:response=_context.sent;dispatch(slice.actions.getProductsSuccess(response.data.products));_context.next=11;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](1);dispatch(slice.actions.hasError(_context.t0));case 11:case\"end\":return _context.stop();}}},_callee,null,[[1,8]]);}));}// ----------------------------------------------------------------------\nexport function getProduct(name){return/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:dispatch(slice.actions.startLoading());_context2.prev=1;_context2.next=4;return axios.get('/api/products/product',{params:{name:name}});case 4:response=_context2.sent;dispatch(slice.actions.getProductSuccess(response.data.product));_context2.next=12;break;case 8:_context2.prev=8;_context2.t0=_context2[\"catch\"](1);console.error(_context2.t0);dispatch(slice.actions.hasError(_context2.t0));case 12:case\"end\":return _context2.stop();}}},_callee2,null,[[1,8]]);}));}","map":{"version":3,"sources":["D:/Projects/Cdss apps/Final version/admin/src/redux/slices/product.js"],"names":["createSlice","sum","map","filter","uniqBy","axios","dispatch","initialState","isLoading","error","products","product","sortBy","filters","gender","category","colors","priceRange","rating","checkout","activeStep","cart","subtotal","total","discount","shipping","billing","slice","name","reducers","startLoading","state","hasError","action","payload","getProductsSuccess","getProductSuccess","sortByProducts","filterProducts","getCart","cartItem","price","quantity","length","addCart","isEmptyCart","_product","isExisted","id","deleteCart","updateCart","item","resetCart","onBackStep","onNextStep","onGotoStep","goToStep","increaseQuantity","productId","decreaseQuantity","createBilling","applyDiscount","applyShipping","reducer","actions","getProducts","get","response","data","getProduct","params","console"],"mappings":"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","sourcesContent":["import { createSlice } from '@reduxjs/toolkit';\nimport { sum, map, filter, uniqBy } from 'lodash';\n// utils\nimport axios from '../../utils/axios';\n//\nimport { dispatch } from '../store';\n\n// ----------------------------------------------------------------------\n\nconst initialState = {\n  isLoading: false,\n  error: null,\n  products: [],\n  product: null,\n  sortBy: null,\n  filters: {\n    gender: [],\n    category: 'All',\n    colors: [],\n    priceRange: '',\n    rating: '',\n  },\n  checkout: {\n    activeStep: 0,\n    cart: [],\n    subtotal: 0,\n    total: 0,\n    discount: 0,\n    shipping: 0,\n    billing: null,\n  },\n};\n\nconst slice = createSlice({\n  name: 'product',\n  initialState,\n  reducers: {\n    // START LOADING\n    startLoading(state) {\n      state.isLoading = true;\n    },\n\n    // HAS ERROR\n    hasError(state, action) {\n      state.isLoading = false;\n      state.error = action.payload;\n    },\n\n    // GET PRODUCTS\n    getProductsSuccess(state, action) {\n      state.isLoading = false;\n      state.products = action.payload;\n    },\n\n    // GET PRODUCT\n    getProductSuccess(state, action) {\n      state.isLoading = false;\n      state.product = action.payload;\n    },\n\n    //  SORT & FILTER PRODUCTS\n    sortByProducts(state, action) {\n      state.sortBy = action.payload;\n    },\n\n    filterProducts(state, action) {\n      state.filters.gender = action.payload.gender;\n      state.filters.category = action.payload.category;\n      state.filters.colors = action.payload.colors;\n      state.filters.priceRange = action.payload.priceRange;\n      state.filters.rating = action.payload.rating;\n    },\n\n    // CHECKOUT\n    getCart(state, action) {\n      const cart = action.payload;\n\n      const subtotal = sum(cart.map((cartItem) => cartItem.price * cartItem.quantity));\n      const discount = cart.length === 0 ? 0 : state.checkout.discount;\n      const shipping = cart.length === 0 ? 0 : state.checkout.shipping;\n      const billing = cart.length === 0 ? null : state.checkout.billing;\n\n      state.checkout.cart = cart;\n      state.checkout.discount = discount;\n      state.checkout.shipping = shipping;\n      state.checkout.billing = billing;\n      state.checkout.subtotal = subtotal;\n      state.checkout.total = subtotal - discount;\n    },\n\n    addCart(state, action) {\n      const product = action.payload;\n      const isEmptyCart = state.checkout.cart.length === 0;\n\n      if (isEmptyCart) {\n        state.checkout.cart = [...state.checkout.cart, product];\n      } else {\n        state.checkout.cart = map(state.checkout.cart, (_product) => {\n          const isExisted = _product.id === product.id;\n          if (isExisted) {\n            return {\n              ..._product,\n              quantity: _product.quantity + 1,\n            };\n          }\n          return _product;\n        });\n      }\n      state.checkout.cart = uniqBy([...state.checkout.cart, product], 'id');\n    },\n\n    deleteCart(state, action) {\n      const updateCart = filter(state.checkout.cart, (item) => item.id !== action.payload);\n\n      state.checkout.cart = updateCart;\n    },\n\n    resetCart(state) {\n      state.checkout.activeStep = 0;\n      state.checkout.cart = [];\n      state.checkout.total = 0;\n      state.checkout.subtotal = 0;\n      state.checkout.discount = 0;\n      state.checkout.shipping = 0;\n      state.checkout.billing = null;\n    },\n\n    onBackStep(state) {\n      state.checkout.activeStep -= 1;\n    },\n\n    onNextStep(state) {\n      state.checkout.activeStep += 1;\n    },\n\n    onGotoStep(state, action) {\n      const goToStep = action.payload;\n      state.checkout.activeStep = goToStep;\n    },\n\n    increaseQuantity(state, action) {\n      const productId = action.payload;\n      const updateCart = map(state.checkout.cart, (product) => {\n        if (product.id === productId) {\n          return {\n            ...product,\n            quantity: product.quantity + 1,\n          };\n        }\n        return product;\n      });\n\n      state.checkout.cart = updateCart;\n    },\n\n    decreaseQuantity(state, action) {\n      const productId = action.payload;\n      const updateCart = map(state.checkout.cart, (product) => {\n        if (product.id === productId) {\n          return {\n            ...product,\n            quantity: product.quantity - 1,\n          };\n        }\n        return product;\n      });\n\n      state.checkout.cart = updateCart;\n    },\n\n    createBilling(state, action) {\n      state.checkout.billing = action.payload;\n    },\n\n    applyDiscount(state, action) {\n      const discount = action.payload;\n      state.checkout.discount = discount;\n      state.checkout.total = state.checkout.subtotal - discount;\n    },\n\n    applyShipping(state, action) {\n      const shipping = action.payload;\n      state.checkout.shipping = shipping;\n      state.checkout.total = state.checkout.subtotal - state.checkout.discount + shipping;\n    },\n  },\n});\n\n// Reducer\nexport default slice.reducer;\n\n// Actions\nexport const {\n  getCart,\n  addCart,\n  resetCart,\n  onGotoStep,\n  onBackStep,\n  onNextStep,\n  deleteCart,\n  createBilling,\n  applyShipping,\n  applyDiscount,\n  increaseQuantity,\n  decreaseQuantity,\n  sortByProducts,\n  filterProducts,\n} = slice.actions;\n\n// ----------------------------------------------------------------------\n\nexport function getProducts() {\n  return async () => {\n    dispatch(slice.actions.startLoading());\n    try {\n      const response = await axios.get('/api/products');\n      dispatch(slice.actions.getProductsSuccess(response.data.products));\n    } catch (error) {\n      dispatch(slice.actions.hasError(error));\n    }\n  };\n}\n\n// ----------------------------------------------------------------------\n\nexport function getProduct(name) {\n  return async () => {\n    dispatch(slice.actions.startLoading());\n    try {\n      const response = await axios.get('/api/products/product', {\n        params: { name },\n      });\n      dispatch(slice.actions.getProductSuccess(response.data.product));\n    } catch (error) {\n      console.error(error);\n      dispatch(slice.actions.hasError(error));\n    }\n  };\n}\n"]},"metadata":{},"sourceType":"module"}